Я тут вовсю расписываю алгоритмы регулировки температуры а совсем забыл рассказать о системе управления в целом.

Система управления у оригинального Brutus 10 довольно проста: два электронных регулятора – для бака горячей воды и для заторного чана, и выключатели для горелок, насосов и общий.



Оригинальный Brutus поддерживает температуру затора с помощью электронного регулятора, который включает-выключает газ и рециркуляции чтобы все равномерно нагревалось. То есть насос снизу забирает сусло и оно льется наверх. В выходном патрубке вставлен термодатчик типа PT100 и на основании его показаний регулятор включает-выключает клапан подачи газа в горелку (в ней есть постоянно горящий запальник, поэтому все само зажигается). Метод простой, но естественно, не очень точный, потому что у системы горелка - бак большая инерционность, ну и точно управлять горелкой невозможно. Кроме того, есть риск пригорания сусла снизу заторного бака.

Поэтому, существуют два более точных способа - оба основаны на том, что сусло при рециркуляции нагревается точно до необходимой температуры. 
В методе HERMS это достигается тем, что сусло проходит по медной трубке, погруженной в горячую воду (температура регулируется вроде управлением скоростью потока). В методе RIMS - внутри трубы стоит электронагреватель, который очень точно поддерживает температуру.

Очень точно управлять температурой можно с помощью PID регулятора. В отличие от простого терморегулятора, PID настраивается на параметры управляемой системы и позволяет практически исключить колебания температуры. Но для этого управляемый элемент (в нашем случае нагреватель) должен плавно регулироваться. В RIMS используется ТЭН который удовлетворяет этим условиям.

В общем, система управления должна бы поддерживать все возможные апгрейды. Еще от системы управления я хочу чтобы все было максимально автоматизировано - чтоб ничего не забыть. А еще чтоб сохранялась история процесса. А еще чтобы задавать рецепт в начале. А еще чтобы с компьютером была связь не знаю зачем. Короче говоря, регуляторы как в оригинальном Brutus мне не подходят. И учитывая то, что я уже исследовал вопрос при организации умного дома для программиста, я решил использовать программируемый контроллер - PLC.

В отличие от умного дома, где контроллеру не нужен HMI - интерфейс с человеком, а по-нашему - панель управления, здесь как раз панель нужна. Нужно и смотреть на параметры - температуру там, или время. Ну и иметь возможность что-то выключить, включит и т.п.

Требования у меня получается такие - как минимум 3 клапана для горелок - это, наверное 24V, два насоса на 220V, два-три входа для термодатчика pt100, ethernet для связи с компом, дисплей с кнопками или тачскрин. 
Вариантов довольно много, но больше всего мне приглянулся Unitronics - тут тебе и интерфейс красивый и все в одном. А еще он используется в системе Brew-Magic.

В результате я приобрел вот что:

unitronics1.jpg (41 KiB) Просмотров: 6


ПЛК V350-35-R34 
Ethernet модуль V100-17-ET2 
Адаптер модулей расширения EX-A1 
Модуль расширения с входами термодатчиков pt100 - IO-PT400

Кроме этого нам понадобятся блок питания 24VDC и трансформатор на 24VAC – для газовых клапанов, реле для управления насосами (в контроллере есть реле, но они наверное слабоваты, поэтому они будут управлять более мощными реле). Понятно, что все в одну панель как в Brutus не влезет – надо делать аппаратный ящик и вынесенную панель управления. Прикидываем на модели габариты ящика и расположение панели:

control.png (36.76 KiB) Просмотров: 6

Идем в магазин и покупаем ящик, реле, трансформатор, блок питания. А еще две кнопки и две лампочки. Вот уже просверленый ящик с установленными кнопками и лампочками:

cb3.jpg (30.83 KiB) Просмотров: 6

Вот внутренности ящика после предварительного монтажа и испытаний.

control2.jpg (62.62 KiB) Просмотров: 6

Верхний ряд – импульсный БП ОВЕН 24V, 60W – питает контроллер, блоки расширения и реле. Затем адаптер модулей расширения EX-A1, затем модуль расширения с входами термодатчиков pt100 - IO-PT400. 
Средний ряд – реле газовых клапанов (одно не подключено – про запас). 
Нижний ряд – трансформатор 24V переменного тока для клапанов, сигнальный зуммер, два реле управления насосами, контактор и предохранительный автомат.

Собственно подключеный контроллер:

control1.jpg (38.4 KiB) Просмотров: 6

Программируется контроллер с помощью среды VisiLogic. Язык – некая смесь LD и FBD, разобраться довольно просто.

visilogic.jpg (76.86 KiB) Просмотров: 6

Интерфейс рисуется там же в дизайнере экранов.
К компьютеру контроллер подключается по COM порту или по сети (у меня же модуль Ethernet установлен). Подключение позволяет загружать туда программу, а также просматривать ее состояние в реальном времени. Также у Unitronics есть утилита Remote Operator, с помощью которой можно удаленно видеть экран, и управлять им. В контроллере есть слот для MicroSD карты куда может писаться вся телеметрия. С этим я еще не разбирался.

Пока запрограммирован ручной режим включения-выключения клапанов и насосов, плюс режим авторегуляции температуры заторника, про который я писал в предыдущих постах.


